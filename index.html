<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fujiseiko (Thailand) Smart Portal</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004080">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <style>
        /* --- 1. CORE & RESET --- */
        :root { 
            --primary: #004080; 
            --accent: #f39c12; 
            --bg: #f0f2f5; 
            --text: #333; 
            --white: #ffffff;
            --shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        * { box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Helvetica, sans-serif; background: var(--bg); margin: 0; color: var(--text); padding-bottom: 60px; }
        html { scroll-behavior: smooth; }

        /* --- 2. HEADER --- */
        header { 
            background: var(--white); padding: 15px 20px; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); 
            position: sticky; top: 0; z-index: 100;
            display: flex; justify-content: space-between; align-items: center;
        }
        h1 { margin: 0; color: var(--primary); font-size: 1.2rem; font-weight: 700; }
        .lang-btn {
            border: 1px solid var(--primary); background: transparent; color: var(--primary);
            padding: 6px 15px; border-radius: 20px; cursor: pointer; font-weight: 600; transition: 0.2s;
        }
        .lang-btn:hover { background: var(--primary); color: white; }

        /* --- 3. CONTAINER & LAYOUT --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

        /* --- 4. FILTER SECTION --- */
        .filter-toggle {
            display: none; /* Desktop hides this */
            width: 100%; padding: 12px; background: white; border: 1px solid #ddd;
            color: var(--primary); font-weight: bold; border-radius: 8px; margin-bottom: 15px;
            cursor: pointer; text-align: center; box-shadow: var(--shadow);
        }

        .filter-box {
            background: var(--white); padding: 25px; border-radius: 12px; 
            box-shadow: var(--shadow); margin-bottom: 30px;
            border-top: 5px solid var(--accent);
        }

        .filter-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; }
        
        .filter-group-title { 
            font-weight: 700; color: var(--primary); border-bottom: 2px solid #eee; 
            padding-bottom: 8px; margin-bottom: 15px; font-size: 1.05rem; display: block;
        }
        
        .sub-group { margin-bottom: 15px; }
        .sub-label { font-size: 0.9rem; font-weight: 600; color: #555; margin-bottom: 8px; display: block; }
        
        .chk-item { 
            display: flex; align-items: center; margin-bottom: 6px; cursor: pointer; 
            font-size: 0.9rem; color: #444; transition: 0.2s;
        }
        .chk-item:hover { color: var(--accent); }
        .chk-item input { margin-right: 10px; accent-color: var(--accent); width: 16px; height: 16px; }
        .chk-item.disabled { opacity: 0.4; cursor: not-allowed; text-decoration: line-through; }
        .chk-item.disabled input { cursor: not-allowed; }

        /* Material Radio Styles */
        .mat-selector { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px dashed #ddd; }
        .radio-label { display: flex; align-items: center; font-weight: bold; cursor: pointer; color: var(--primary); }
        .radio-label input { margin-right: 8px; width: 18px; height: 18px; accent-color: var(--primary); }

        /* --- 5. PRODUCT GRID --- */
        .section-head { 
            font-size: 1.4rem; font-weight: 700; color: #444; margin: 40px 0 20px; 
            display: flex; align-items: center; border-left: 5px solid var(--primary); padding-left: 15px;
        }
        .count-badge { background: #e0e0e0; color: #333; font-size: 0.8rem; padding: 3px 10px; border-radius: 12px; margin-left: 10px; vertical-align: middle; }

        .product-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); 
            gap: 20px; 
        }

        /* --- 6. CARD DESIGN --- */
        .card { 
            background: var(--white); border-radius: 12px; overflow: hidden; 
            box-shadow: var(--shadow); transition: transform 0.2s, box-shadow 0.2s;
            border: 1px solid transparent; display: flex; flex-direction: column;
        }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); border-color: var(--accent); }

        .card-img-box { 
            height: 180px; background: #fff; padding: 20px; 
            display: flex; align-items: center; justify-content: center; 
            border-bottom: 1px solid #f0f0f0; 
        }
        .card-img-box img { max-width: 100%; max-height: 100%; object-fit: contain; }

        .card-content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        .card-title { font-size: 1.15rem; font-weight: 700; color: var(--primary); margin: 0 0 5px; }
        .card-type { font-size: 0.85rem; color: #888; margin-bottom: 10px; font-weight: 500; }
        .card-desc { 
            font-size: 0.9rem; color: #555; line-height: 1.5; margin-bottom: 15px; flex-grow: 1;
            background: #f8f9fa; padding: 10px; border-radius: 6px;
        }

        .card-btns { display: flex; gap: 10px; margin-top: auto; }
        .btn { 
            flex: 1; padding: 10px; border-radius: 6px; text-align: center; text-decoration: none; 
            font-size: 0.9rem; font-weight: 600; cursor: pointer; border: none; transition: 0.2s;
        }
        .btn-link { background: #eef2f6; color: var(--primary); }
        .btn-link:hover { background: #dce4ec; }
        .btn-calc { background: var(--accent); color: white; }
        .btn-calc:hover { background: #d35400; }

        /* --- 7. MODAL --- */
        .modal-overlay { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.7); z-index: 1000; display: none; 
            align-items: center; justify-content: center; padding: 20px;
        }
        .modal-box { 
            background: white; width: 100%; max-width: 400px; padding: 25px; 
            border-radius: 12px; position: relative; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        
        .close-modal { position: absolute; top: 15px; right: 20px; font-size: 1.8rem; cursor: pointer; color: #999; line-height: 1; }
        
        .calc-input { width: 100%; padding: 12px; font-size: 1.2rem; border: 2px solid #eee; border-radius: 8px; text-align: center; margin-top: 10px; }
        .calc-input:focus { border-color: var(--accent); outline: none; }
        
        .calc-result { 
            margin-top: 20px; background: #f8f9fa; padding: 20px; border-radius: 8px; border: 1px solid #eee; 
            display: grid; grid-template-columns: 1fr; gap: 15px;
        }
        .res-row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #ddd; padding-bottom: 10px; }
        .res-row:last-child { border-bottom: none; padding-bottom: 0; }
        .res-val { font-size: 1.2rem; font-weight: 700; color: var(--primary); }

        /* --- 8. SCROLL TOP BUTTON --- */
        #scrollTopBtn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 99;
            font-size: 24px;
            border: none;
            outline: none;
            background-color: var(--accent);
            color: white;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            display: none; /* Hidden by default */
            align-items: center;
            justify-content: center;
            transition: transform 0.3s, background-color 0.3s;
        }
        #scrollTopBtn:hover {
            transform: scale(1.1);
            background-color: #d35400;
        }

        /* --- 9. MOBILE RESPONSIVE TWEAKS --- */
        @media (max-width: 768px) {
            .filter-toggle { display: block; }
            .filter-box { display: none; }
            .filter-box.active { display: block; animation: fadeIn 0.3s; }
            
            .container { padding: 15px; }
            .card-img-box { height: 150px; }
            .product-grid { grid-template-columns: repeat(auto-fill, minmax(45%, 1fr)); gap: 10px; }
            h1 { font-size: 1rem; }
        }

        @media (max-width: 480px) {
            .product-grid { grid-template-columns: 1fr; } 
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<header>
    <h1>Fujiseiko (Thailand)</h1>
    <button class="lang-btn" onclick="toggleLang()">EN / TH</button>
</header>

<div class="container">

    <button class="filter-toggle" onclick="toggleFilterDisplay()">
        üîç Show / Hide Filters (‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á)
    </button>

    <div class="filter-box" id="filterPanel">
        <div class="mat-selector">
            <label class="radio-label"><input type="radio" name="mat" value="all" checked onchange="render()"> All Materials</label>
            <label class="radio-label"><input type="radio" name="mat" value="al" onchange="render()"> For Aluminum</label>
            <label class="radio-label"><input type="radio" name="mat" value="st" onchange="render()"> For Steel & Iron</label>
        </div>

        <div class="filter-grid">
            <div>
                <span class="filter-group-title">1. Fundamental Info</span>
                <div class="sub-group">
                    <span class="sub-label">Function</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="func" value="Drill"> Drill (‡πÄ‡∏à‡∏≤‡∏∞)</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="func" value="Reamer"> Reamer (‡∏£‡∏µ‡∏°)</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="func" value="Drill & Reamer"> Drill & Reamer</label>
                </div>
                <div class="sub-group">
                    <span class="sub-label">Target Process</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="proc" value="General Hole Cutting"> General (‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ)</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="proc" value="One Shot Cutting for W/O Prehole"> One Shot (Solid)</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="proc" value="For Cored Hole"> For Cored Hole</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="proc" value="High Efficiency Cutting"> High Efficiency</label>
                </div>
            </div>

            <div>
                <span class="filter-group-title">2. Prepared Hole</span>
                <div class="sub-group">
                    <span class="sub-label">Cored Hole (‡∏£‡∏π‡∏´‡∏•‡πà‡∏≠)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_cored" value="Excellent"> Excellent</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_cored" value="Good"> Good</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_cored" value="Fair"> Fair</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_cored" value="No"> No</label>
                </div>
                <div class="sub-group">
                    <span class="sub-label">W/O Prehole (‡∏£‡∏π‡∏ï‡∏±‡∏ô)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_solid" value="Excellent"> Excellent</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_solid" value="Good"> Good</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_solid" value="Fair"> Fair</label>
                </div>
                <div class="sub-group">
                    <span class="sub-label">Through Hole (‡∏£‡∏π‡∏ó‡∏∞‡∏•‡∏∏)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="hole_through" value="Good"> Good</label>
                </div>
            </div>

            <div>
                <span class="filter-group-title">3. Performance</span>
                <div class="sub-group">
                    <span class="sub-label">Roughness (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ö)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_rough" value="Excellent"> Excellent</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_rough" value="Good"> Good</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_rough" value="Fair"> Fair</label>
                </div>
                <div class="sub-group">
                    <span class="sub-label">Position (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_pos" value="Excellent"> Excellent</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_pos" value="Good"> Good</label>
                </div>
                <div class="sub-group">
                    <span class="sub-label">Circularity (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏°)</span>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_circ" value="Excellent"> Excellent</label>
                    <label class="chk-item"><input type="checkbox" class="flt" data-key="perf_circ" value="Good"> Good</label>
                </div>
            </div>
        </div>
        
        <div style="text-align:right; margin-top:20px; border-top:1px solid #eee; padding-top:10px;">
            <span onclick="resetFilters()" style="color:#d35400; cursor:pointer; font-weight:bold; font-size:0.9rem;">‚Ü∫ Reset Filters</span>
        </div>
    </div>

    <div id="sec-al">
        <div class="section-head">
            For Aluminum <span class="count-badge" id="cnt-al">0</span>
        </div>
        <div class="product-grid" id="grid-al"></div>
    </div>

    <div id="sec-st">
        <div class="section-head">
            For Steel & Cast Iron <span class="count-badge" id="cnt-st">0</span>
        </div>
        <div class="product-grid" id="grid-st"></div>
    </div>

</div>

<button id="scrollTopBtn" onclick="scrollToTop()" title="Go to top">‚Üë</button>

<div class="modal-overlay" id="calcModal" onclick="if(event.target===this) closeModal()">
    <div class="modal-box">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <h3 style="margin:0 0 5px; color:var(--primary);">Condition Calculator</h3>
        <p id="calc-tool-name" style="color:#666; margin:0 0 20px; font-size:0.95rem;"></p>
        
        <label style="font-weight:bold; color:#333;">Input Hole Diameter (mm):</label>
        <input type="number" id="inp-dia" class="calc-input" placeholder="e.g. 10.0" oninput="calculate()">
        
        <div class="calc-result">
            <div class="res-row">
                <span style="font-size:0.9rem; color:#666;">Speed (m/min)</span>
                <span id="res-vc" class="res-val">-</span>
            </div>
            <div class="res-row">
                <span style="font-size:0.9rem; color:#666;">Feed (mm/rev)</span>
                <span id="res-feed" class="res-val">-</span>
            </div>
        </div>
    </div>
</div>

<script>
    // --- PWA Service Worker ---
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service-worker.js').catch(err => console.log('SW fail', err));
        });
    }

    // --- DATA ---
    const tools = [
        // ALUMINUM
        { id: "gkz", name: "GKZ Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gkdrill.html", img: "images/gkz_main.jpg", func: "Drill", proc: "General Hole Cutting", hole: { cored: "Good", solid: "Excellent", through:"Good" }, perf: { rough: "Good", pos: "Good", circ: "Good" }, feat_en: "Excellent straightness even in cored holes. DLC coating.", feat_th: "‡∏£‡∏π‡∏ï‡∏£‡∏á‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡πÅ‡∏°‡πâ‡πÉ‡∏ô‡∏£‡∏π‡∏´‡∏•‡πà‡∏≠ ‡πÄ‡∏Ñ‡∏•‡∏∑‡∏≠‡∏ö DLC ‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô", calc: { vc_min: 50, vc_max: 250, f_min: 0.02, f_max: 0.04, f_mode: "fac" } },
        { id: "gkt", name: "GKT Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gkdrill.html", img: "images/gkt_main.jpg", func: "Drill", proc: "For Cored Hole", hole: { cored: "Excellent", solid: "Fair", through:"Good" }, perf: { rough: "Good", pos: "Excellent", circ: "Good" }, feat_en: "3-flute design for high positional accuracy in cored holes.", feat_th: "3 ‡∏Ñ‡∏°‡∏ï‡∏±‡∏î ‡πÉ‡∏´‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏™‡∏π‡∏á‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏π‡∏´‡∏•‡πà‡∏≠", calc: { vc_min: 50, vc_max: 200, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "g7x", name: "G7X Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/g7drill.html", img: "images/g7x_main.jpg", func: "Drill & Reamer", proc: "One Shot Cutting for W/O Prehole", hole: { cored: "Good", solid: "Excellent", through:"Good" }, perf: { rough: "Excellent", pos: "Good", circ: "Excellent" }, feat_en: "IT7 accuracy in one shot (Drill + Reamer).", feat_th: "‡πÑ‡∏î‡πâ‡∏£‡∏π‡∏£‡∏∞‡∏î‡∏±‡∏ö IT7 ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (‡πÄ‡∏à‡∏≤‡∏∞+‡∏£‡∏µ‡∏°)", calc: { vc_min: 50, vc_max: 200, f_min: 0.1, f_max: 0.2, f_mode: "fix" } },
        { id: "gp", name: "GP Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gpdrill.html", img: "images/gp_main.jpg", func: "Drill", proc: "One Shot Cutting for W/O Prehole", hole: { cored: "Good", solid: "Excellent", through:"Good" }, perf: { rough: "Excellent", pos: "Good", circ: "Good" }, feat_en: "PCD-tipped for high speed & long life (IT8).", feat_th: "‡∏´‡∏±‡∏ß PCD ‡πÄ‡∏à‡∏≤‡∏∞‡πÄ‡∏£‡πá‡∏ß ‡∏≠‡∏≤‡∏¢‡∏∏‡∏¢‡∏≤‡∏ß‡∏ô‡∏≤‡∏ô (IT8)", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.15, f_mode: "fac" } },
        { id: "gpt", name: "GPT Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gpdrill.html", img: "images/gpt_main.jpg", func: "Drill", proc: "One Shot Cutting for Cored Prehole", hole: { cored: "Excellent", solid: "Fair", through:"Good" }, perf: { rough: "Excellent", pos: "Excellent", circ: "Good" }, feat_en: "3-flute PCD for high speed in cored holes.", feat_th: "PCD 3 ‡∏Ñ‡∏°‡∏ï‡∏±‡∏î ‡πÄ‡∏à‡∏≤‡∏∞‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏´‡∏•‡πà‡∏≠", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "gjt", name: "GJT Drill", cat: "al", link: "pdfs/gjt.pdf", img: "images/gjt_main.jpg", func: "Drill", proc: "One Shot Cutting for Cored Prehole", hole: { cored: "Excellent", solid: "Fair", through:"Good" }, perf: { rough: "Excellent", pos: "Excellent", circ: "Excellent" }, feat_en: "3 PCD edges + 6 guide pads for IT7 roundness.", feat_th: "3 ‡∏Ñ‡∏° PCD + 6 ‡πÑ‡∏Å‡∏î‡πå ‡πÑ‡∏î‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏° IT7", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "gd", name: "GD Drill", cat: "al", link: "pdfs/gd.pdf", img: "images/gd_main.jpg", func: "Drill & Reamer", proc: "One Shot Cutting for W/O Prehole", hole: { cored: "Fair", solid: "Excellent", through:"Good" }, perf: { rough: "Excellent", pos: "Good", circ: "Excellent" }, feat_en: "PCD reamer + pilot drill for IT7 in one pass.", feat_th: "‡∏£‡∏µ‡∏° PCD + ‡∏î‡∏≠‡∏Å‡∏ô‡∏≥‡πÄ‡∏à‡∏≤‡∏∞ ‡πÑ‡∏î‡πâ IT7 ‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß", calc: { vc_min: 100, vc_max: 200, f_min: 0.05, f_max: 0.2, f_mode: "fix" } },
        { id: "tfh", name: "TFH Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/tfhdrill.html", img: "images/tfh_main.jpg", func: "Drill", proc: "High Efficiency Cutting", hole: { cored: "Fair", solid: "Good", through:"Good" }, perf: { rough: "Good", pos: "Good", circ: "Good" }, feat_en: "Low resistance, high feed (0.15D).", feat_th: "‡πÅ‡∏£‡∏á‡∏ï‡πâ‡∏≤‡∏ô‡∏ï‡πà‡∏≥ ‡∏ü‡∏µ‡∏î‡∏™‡∏π‡∏á (0.15D)", calc: { vc_min: 50, vc_max: 150, f_min: 0.05, f_max: 0.15, f_mode: "fac", f_limit: 2.0 } },
        { id: "manmaruz", name: "Manmaru Z", cat: "al", link: "https://www.c-max.co.jp/en/products/zreamer.html", img: "images/manmaruz_main.jpg", func: "Reamer", proc: "Finish Cutting even in Discontinuous hole", hole: { cored: "No", solid: "No", through:"Good" }, perf: { rough: "Excellent", pos: "No", circ: "Excellent" }, feat_en: "Stable roundness in intermittent cutting.", feat_th: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏°‡πÄ‡∏™‡∏ñ‡∏µ‡∏¢‡∏£ ‡πÅ‡∏°‡πâ‡∏ï‡∏±‡∏î‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á", calc: { vc_min: 50, vc_max: 400, f_min: 0.05, f_max: 0.2, f_mode: "fix" } },
        { id: "parapara", name: "Parapara", cat: "al", link: "https://www.c-max.co.jp/en/products/paraparadrill.html", img: "images/parapara_main.jpg", func: "Drill", proc: "General Hole Cutting", hole: { cored: "Good", solid: "Good", through:"Good" }, perf: { rough: "Fair", pos: "Good", circ: "Good" }, feat_en: "Breaks chips into small pieces for deep holes.", feat_th: "‡∏´‡∏±‡∏Å‡πÄ‡∏®‡∏©‡πÄ‡∏•‡πá‡∏Å ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡∏≤‡∏∞‡∏£‡∏π‡∏•‡∏∂‡∏Å", calc: { vc_min: 50, vc_max: 150, f_min: 0.02, f_max: 0.1, f_mode: "fac" } },
        { id: "balance", name: "Balance", cat: "al", link: "https://www.c-max.co.jp/en/products/balancereamer.html", img: "images/balance_main.jpg", func: "Reamer", proc: "General Hole Cutting", hole: { cored: "Good", solid: "Good", through:"Good" }, perf: { rough: "Excellent", pos: "Good", circ: "Good" }, feat_en: "Outstanding rotational balance for deep holes.", feat_th: "‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏´‡∏°‡∏∏‡∏ô‡∏î‡∏µ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏° ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏•‡∏∂‡∏Å", calc: { vc_min: 100, vc_max: 300, f_min: 0.05, f_max: 0.1, f_mode: "fix" } },
        
        // STEEL
        { id: "tfs", name: "TFS Drill", cat: "st", link: "https://www.c-max.co.jp/en/products/tfsdrill.html", img: "images/tfs_main.jpg", func: "Drill", proc: "General Hole Cutting", hole: { cored: "No", solid: "Good", through:"Good" }, perf: { rough: "Good", pos: "Good", circ: "Good" }, feat_en: "Low-resistance edge for Steel/Cast Iron.", feat_th: "‡∏Ñ‡∏°‡∏ï‡∏±‡∏î‡πÅ‡∏£‡∏á‡∏ï‡πâ‡∏≤‡∏ô‡∏ï‡πà‡∏≥ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏•‡πá‡∏Å/‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏´‡∏•‡πà‡∏≠", calc: { vc_min: 50, vc_max: 120, f_min: 0.01, f_max: 0.05, f_mode: "fac" } },
        { id: "gix", name: "GIX Drill", cat: "st", link: "pdfs/gix.pdf", img: "images/gix_main.jpg", func: "Drill", proc: "General Hole Cutting", hole: { cored: "No", solid: "Good", through:"Good" }, perf: { rough: "Good", pos: "Good", circ: "Good" }, feat_en: "Straight flutes for cast iron straightness.", feat_th: "‡∏£‡πà‡∏≠‡∏á‡∏ï‡∏£‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏£‡∏á‡πÉ‡∏ô‡∏á‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏´‡∏•‡πà‡∏≠", calc: { vc_min: 50, vc_max: 150, f_min: 0.04, f_max: 0.04, f_mode: "fac", f_limit: 0.1 } },
        { id: "gf", name: "GF Drill", cat: "st", link: "pdfs/gf.pdf", img: "images/gf_main.jpg", func: "Drill & Reamer", proc: "One Shot Cutting for W/O Prehole", hole: { cored: "No", solid: "Good", through:"Good" }, perf: { rough: "Good", pos: "Good", circ: "Good" }, feat_en: "2 pilot + 4 reaming edges for cast iron (IT8).", feat_th: "2 ‡∏Ñ‡∏°‡∏ô‡∏≥ + 4 ‡∏Ñ‡∏°‡∏£‡∏µ‡∏° ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏´‡∏•‡πà‡∏≠ (IT8)", calc: { vc_min: 20, vc_max: 100, f_min: 0.05, f_max: 0.3, f_mode: "fix" } },
        { id: "ghi", name: "GHI Reamer", cat: "st", link: "https://www.c-max.co.jp/en/products/ghireamer.html", img: "images/ghi_main.jpg", func: "Reamer", proc: "High Efficiency Finish Cutting", hole: { cored: "No", solid: "No", through:"Good" }, perf: { rough: "Excellent", pos: "No", circ: "Excellent" }, feat_en: "6 unequal edges for roundness & anti-vibration.", feat_th: "6 ‡∏Ñ‡∏°‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏•‡∏°‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏™‡∏±‡πà‡∏ô", calc: { vc_min: 50, vc_max: 150, f_min: 0.2, f_max: 0.6, f_mode: "fix" } }
    ];

    let curLang = "EN";

    // --- RENDER ---
    function render() {
        const matFilter = document.querySelector('input[name="mat"]:checked').value;
        const checked = Array.from(document.querySelectorAll('.flt:checked'));
        const filters = checked.map(cb => ({ key: cb.dataset.key, val: cb.value }));

        let htmlAl = "", htmlSt = "";
        let countAl = 0, countSt = 0;

        tools.forEach(t => {
            if(matFilter !== 'all' && t.cat !== matFilter) return;

            let pass = true;
            // Interdependent Filter Logic
            const grouped = {};
            filters.forEach(f => {
                if(!grouped[f.key]) grouped[f.key] = [];
                grouped[f.key].push(f.val);
            });

            for(const key in grouped) {
                const reqs = grouped[key];
                let val = getVal(t, key);
                if(!reqs.includes(val)) { pass = false; break; }
            }

            if(pass) {
                const desc = curLang === 'EN' ? t.feat_en : t.feat_th;
                const linkLabel = t.link.includes('.pdf') ? 'üìÑ PDF' : 'üåê Spec';
                
                const card = `
                <div class="card">
                    <div class="card-img-box">
                        <img src="${t.img}" onerror="this.src='https://placehold.co/200?text=${t.name[0]}'">
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${t.name}</h3>
                        <div class="card-type">${t.func} | ${t.proc}</div>
                        <div class="card-desc">${desc}</div>
                        <div class="card-btns">
                            <a href="${t.link}" target="_blank" class="btn btn-link">${linkLabel}</a>
                            <button onclick="openCalc('${t.id}')" class="btn btn-calc">‚ö° Calc</button>
                        </div>
                    </div>
                </div>`;

                if(t.cat === 'al') { htmlAl += card; countAl++; }
                else { htmlSt += card; countSt++; }
            }
        });

        document.getElementById('grid-al').innerHTML = htmlAl;
        document.getElementById('cnt-al').innerText = countAl;
        document.getElementById('sec-al').style.display = (countAl > 0) ? 'block' : 'none';

        document.getElementById('grid-st').innerHTML = htmlSt;
        document.getElementById('cnt-st').innerText = countSt;
        document.getElementById('sec-st').style.display = (countSt > 0) ? 'block' : 'none';

        updateFilterUI();
    }

    function getVal(t, k) {
        if(k==='func') return t.func;
        if(k==='proc') return t.proc;
        if(k==='hole_cored') return t.hole.cored;
        if(k==='hole_solid') return t.hole.solid;
        if(k==='hole_through') return t.hole.through;
        if(k==='perf_rough') return t.perf.rough;
        if(k==='perf_pos') return t.perf.pos;
        if(k==='perf_circ') return t.perf.circ;
        return "";
    }

    // --- UI HELPERS ---
    function updateFilterUI() {
        const boxes = document.querySelectorAll('.flt');
        boxes.forEach(box => box.parentElement.classList.remove('disabled'));
    }

    function toggleLang() {
        curLang = curLang === 'EN' ? 'TH' : 'EN';
        render();
    }

    function toggleFilterDisplay() {
        const panel = document.getElementById('filterPanel');
        if(panel.style.display === 'block') panel.style.display = 'none';
        else panel.style.display = 'block';
    }

    function resetFilters() {
        document.querySelectorAll('.flt').forEach(c => c.checked = false);
        render();
    }

    document.querySelectorAll('.flt').forEach(c => c.addEventListener('change', render));

    // --- SCROLL TOP LOGIC ---
    window.onscroll = function() {
        const btn = document.getElementById("scrollTopBtn");
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            btn.style.display = "flex";
        } else {
            btn.style.display = "none";
        }
    };

    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // --- CALCULATOR ---
    let actTool = null;
    function openCalc(id) {
        actTool = tools.find(t => t.id === id);
        document.getElementById('calc-tool-name').innerText = "Model: " + actTool.name;
        document.getElementById('inp-dia').value = '';
        document.getElementById('res-vc').innerText = `${actTool.calc.vc_min}~${actTool.calc.vc_max}`;
        document.getElementById('res-feed').innerText = '-';
        document.querySelector('.modal-overlay').style.display = 'flex';
        document.getElementById('inp-dia').focus();
    }

    function calculate() {
        const d = parseFloat(document.getElementById('inp-dia').value);
        if(!d || d<=0) return;

        let f_min, f_max;
        if(actTool.calc.f_mode === 'fix') {
            f_min = actTool.calc.f_min;
            f_max = actTool.calc.f_max;
        } else {
            f_min = actTool.calc.f_min * d;
            f_max = actTool.calc.f_max * d;
        }

        if(actTool.calc.f_limit) {
            f_min = Math.min(f_min, actTool.calc.f_limit);
            f_max = Math.min(f_max, actTool.calc.f_limit);
        }

        const s_min = parseFloat(f_min.toFixed(3));
        const s_max = parseFloat(f_max.toFixed(3));
        
        document.getElementById('res-feed').innerText = (s_min === s_max) ? s_min : `${s_min}~${s_max}`;
    }

    function closeModal() {
        document.querySelector('.modal-overlay').style.display = 'none';
    }

    render();
</script>

</body>
</html>
