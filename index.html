<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fujiseiko (Thailand) Smart Portal</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004080">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <style>
        /* --- CORE STYLES --- */
        :root { --primary: #004080; --accent: #f39c12; --bg: #f4f7f6; --text: #333; --card-bg: #fff; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: var(--bg); margin: 0; color: var(--text); padding-bottom: 60px; }
        * { box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        /* --- HEADER --- */
        header { 
            background: #fff; padding: 10px 20px; 
            position: sticky; top: 0; z-index: 100; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            display: flex; justify-content: space-between; align-items: center;
        }
        .header-logo { height: 45px; width: auto; object-fit: contain; }
        
        .lang-btn {
            background: var(--primary); color: white; border: none;
            padding: 6px 15px; border-radius: 20px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: 0.2s;
        }
        .lang-btn:hover { background: #003060; }

        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

        /* --- TABS --- */
        .mat-tabs { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .mat-tab { 
            padding: 8px 25px; border-radius: 20px; font-weight: 600; font-size: 0.95rem; cursor: pointer; background: #e0e0e0; color: #555; transition: 0.2s;
        }
        .mat-tab.active { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(0,64,128,0.3); }

        /* --- FILTER PANEL --- */
        .filter-toggle {
            display: block; width: 100%; padding: 12px; background: white; border: 1px solid #ddd;
            color: var(--primary); font-weight: bold; border-radius: 8px; margin-bottom: 20px;
            cursor: pointer; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .filter-box { display: none; background: white; padding: 25px; border-radius: 10px; margin-bottom: 20px; border:1px solid #eee; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .filter-box.show { display: block; animation: fadeDown 0.3s; }
        
        .filter-grid-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .f-col h4 { margin: 0 0 15px 0; color: var(--primary); font-size: 1rem; border-bottom: 2px solid #eee; padding-bottom: 8px; }
        
        .sub-group { margin-bottom: 15px; }
        
        /* Filter Images (Large Size) */
        .sub-head-box { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 8px; }
        .sub-head-img { 
            width: 80px; 
            height: 80px; 
            object-fit: contain; background: #fff; border: 1px solid #ddd; border-radius: 4px; 
        }
        .sub-title { font-weight: 700; font-size: 0.9rem; color: #555; }
        
        .chk-label { display: block; margin-bottom: 6px; font-size: 0.9rem; color: #444; cursor: pointer; padding-left: 5px; }
        .chk-label:hover { color: var(--accent); }
        .chk-label input { margin-right: 8px; accent-color: var(--accent); transform: scale(1.1); }
        .chk-label.disabled { color: #ccc; text-decoration: line-through; }

        /* --- CARDS --- */
        .product-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px; 
        }
        .dash-card {
            background: var(--card-bg); border-radius: 10px; overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08); border: 1px solid #e0e0e0;
            display: flex; flex-direction: column; transition: transform 0.2s;
        }
        .dash-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); border-color: var(--primary); }

        .dc-header { display: flex; padding: 15px; border-bottom: 1px solid #eee; background: #fff; align-items: center; gap: 15px; }
        
        /* Tool Image (Large Size) */
        .dc-img { 
            width: 140px; 
            height: 140px; 
            object-fit: contain; border-radius: 6px; border: 1px solid #eee; padding: 2px; 
        }
        
        .dc-title-box { flex: 1; }
        .dc-title { margin: 0; font-size: 1.15rem; font-weight: 800; color: var(--primary); }
        .dc-sub { font-size: 0.8rem; color: #666; margin-top: 3px; font-weight: 500; }
        .tag { display: inline-block; background: #eef2f5; padding: 2px 8px; border-radius: 4px; font-size: 0.75rem; color: #555; margin-right: 5px; border: 1px solid #ddd; }

        .dc-dashboard { padding: 15px; background: #fdfdfd; flex: 1; }
        .dash-row { display: flex; gap: 15px; margin-bottom: 12px; }
        .dash-col { flex: 1; }
        .dash-head { font-size: 0.75rem; font-weight: 700; color: #999; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 8px; border-bottom: 1px dashed #ddd; padding-bottom: 2px; }

        .spec-item { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; font-size: 0.8rem; }
        .spec-label { color: #555; font-weight: 500; }
        
        .star-box { font-family: sans-serif; letter-spacing: 1px; font-size: 0.9rem; }
        .s-on { color: #f39c12; }
        .s-off { color: #ddd; }
        .s-no { color: #ccc; font-size: 0.8rem; font-weight: bold; }

        .dc-feat { font-size: 0.85rem; color: #666; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee; font-style: italic; line-height: 1.4; min-height: 3.5em; }

        .dc-footer { padding: 12px 15px; background: #fff; border-top: 1px solid #eee; display: flex; gap: 10px; }
        .btn { flex: 1; padding: 10px; border-radius: 6px; text-align: center; text-decoration: none; font-size: 0.9rem; font-weight: 600; cursor: pointer; transition: 0.2s; border: none; }
        .btn-info { background: #fff; border: 1px solid #ddd; color: var(--primary); }
        .btn-info:hover { background: #f0f4f8; border-color: var(--primary); }
        .btn-calc { background: var(--accent); color: white; }
        .btn-calc:hover { background: #d35400; }

        /* --- SCROLL TOP BUTTON --- */
        #scrollTopBtn {
            position: fixed;
            bottom: 30px;
            right: 20px;
            z-index: 9999;
            font-size: 20px;
            border: none;
            outline: none;
            background-color: var(--accent);
            color: white;
            cursor: pointer;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            display: none;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s, background-color 0.3s, opacity 0.3s;
            -webkit-tap-highlight-color: transparent;
        }
        #scrollTopBtn:active { transform: scale(0.95); }

        /* --- MODAL --- */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 200; display: none; justify-content: center; align-items: center; }
        .modal-box { background: white; width: 90%; max-width: 400px; padding: 25px; border-radius: 12px; position: relative; animation: popUp 0.3s; }
        .calc-input { width: 100%; padding: 12px; margin: 15px 0; border: 2px solid #ddd; border-radius: 8px; font-size: 1.2rem; text-align: center; }
        .res-grid { display: grid; grid-template-columns: 1fr; gap: 10px; background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center; }
        .res-val { font-size: 1.4rem; font-weight: 800; color: var(--primary); }

        @keyframes fadeDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popUp { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        @media (max-width: 768px) { .product-grid { grid-template-columns: 1fr; } .dash-row { flex-direction: column; gap: 10px; } .dash-col { border-left: none !important; border-top: 1px dashed #eee; padding-left: 0 !important; padding-top: 10px; } }
    </style>
</head>
<body>

<header>
    <img src="images/fst.jpg" alt="Fujiseiko (Thailand)" class="header-logo">
    <button class="lang-btn" id="btnLang" onclick="toggleLang()">EN / TH</button>
</header>

<div class="container">
    
    <div class="mat-tabs">
        <div class="mat-tab active" id="tabAll" onclick="setMat('all', this)">All</div>
        <div class="mat-tab" id="tabAl" onclick="setMat('al', this)">Aluminum</div>
        <div class="mat-tab" id="tabSt" onclick="setMat('st', this)">Steel/Iron</div>
    </div>

    <button class="filter-toggle" id="btnFilterToggle" onclick="toggleFilter()">⚙️ Advanced Filter</button>
    
    <div class="filter-box" id="filterPanel">
        <div class="filter-grid-layout">
            
            <div class="f-col">
                <h4 id="hFund">1. Fundamental Info</h4>
                
                <div class="sub-group">
                    <span class="sub-title" id="tFunc">Function</span>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="func" value="Drill"> <span data-t="Drill">Drill</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="func" value="Reamer"> <span data-t="Reamer">Reamer</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="func" value="Drill & Reamer"> <span data-t="Drill & Reamer">Drill & Reamer</span></label>
                </div>
                
                <div class="sub-group">
                    <span class="sub-title" id="tProc">Target Process</span>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="proc" value="General"> <span data-t="General">General</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="proc" value="One Shot"> <span data-t="One Shot">One Shot (Solid)</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="proc" value="For Cored Hole"> <span data-t="For Cored Hole">For Cored Hole</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="proc" value="High Efficiency"> <span data-t="High Efficiency">High Efficiency</span></label>
                </div>
            </div>

            <div class="f-col">
                <h4 id="hHole">2. Prepared Hole</h4>
                
                <div class="sub-group">
                    <div class="sub-head-box">
                        <img src="images/cored.jpg" class="sub-head-img" alt="Cored">
                        <span class="sub-title" id="tCored">Cored Hole</span>
                    </div>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_cored" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_cored" value="Good"> <span data-t="Good">Good</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_cored" value="Fair"> <span data-t="Fair">Fair</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_cored" value="No"> <span data-t="No">No</span></label>
                </div>

                <div class="sub-group">
                    <div class="sub-head-box">
                        <img src="images/solid.jpg" class="sub-head-img" alt="Solid">
                        <span class="sub-title" id="tSolid">Without Prehole (Solid)</span>
                    </div>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_solid" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_solid" value="Good"> <span data-t="Good">Good</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_solid" value="Fair"> <span data-t="Fair">Fair</span></label>
                </div>

                <div class="sub-group">
                    <div class="sub-head-box">
                        <img src="images/blind.jpg" class="sub-head-img" alt="Blind">
                        <span class="sub-title" id="tBlind">Blind Hole</span>
                    </div>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_blind" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_blind" value="Good"> <span data-t="Good">Good</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_blind" value="Fair"> <span data-t="Fair">Fair</span></label>
                </div>

                <div class="sub-group">
                    <div class="sub-head-box">
                        <img src="images/through.jpg" class="sub-head-img" alt="Through">
                        <span class="sub-title" id="tThrough">Through Hole</span>
                    </div>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="hole_through" value="Good"> <span data-t="Good">Good</span></label>
                </div>
            </div>

            <div class="f-col">
                <h4 id="hPerf">3. Performance</h4>
                
                <div class="sub-group">
                    <span class="sub-title" id="tRough">Roughness</span>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_rough" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_rough" value="Good"> <span data-t="Good">Good</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_rough" value="Fair"> <span data-t="Fair">Fair</span></label>
                </div>
                
                <div class="sub-group">
                    <span class="sub-title" id="tPos">Position</span>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_pos" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_pos" value="Good"> <span data-t="Good">Good</span></label>
                </div>
                
                <div class="sub-group">
                    <span class="sub-title" id="tCirc">Circularity</span>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_circ" value="Excellent"> <span data-t="Excellent">Excellent</span></label>
                    <label class="chk-label"><input type="checkbox" class="flt" data-key="perf_circ" value="Good"> <span data-t="Good">Good</span></label>
                </div>
            </div>

        </div>
        <div style="text-align: right; margin-top: 15px; border-top:1px solid #eee; padding-top:10px;">
            <span id="btnReset" style="color: var(--accent); cursor: pointer; font-weight:bold;" onclick="resetFilters()">↺ Reset Filters</span>
        </div>
    </div>

    <div class="product-grid" id="main-grid"></div>

</div>

<button id="scrollTopBtn" onclick="scrollToTop()" title="Go to top">↑</button>

<div class="modal-overlay" id="calcModal" onclick="if(event.target===this) closeModal()">
    <div class="modal-box">
        <span style="position:absolute; top:15px; right:20px; font-size:1.5rem; cursor:pointer; color:#999;" onclick="closeModal()">&times;</span>
        <h3 id="calcTitle" style="margin-top:0; color:var(--primary);">Cutting Calculator</h3>
        <p id="calc-tool-name" style="color:#666; font-size:0.9rem;"></p>
        
        <input type="number" id="inp-dia" class="calc-input" placeholder="Hole Dia (mm)" oninput="calculate()">
        
        <div class="res-grid">
            <div>
                <div id="lblSpeed" style="font-size:0.8rem; color:#666;">Speed (m/min)</div>
                <div id="res-vc" class="res-val">-</div>
            </div>
            <div style="border-top:1px solid #eee; padding-top:10px; margin-top:5px;">
                <div id="lblFeed" style="font-size:0.8rem; color:#666;">Feed (mm/rev)</div>
                <div id="res-feed" class="res-val">-</div>
            </div>
        </div>
    </div>
</div>

<script>
    // --- SCROLL TOP LOGIC ---
    window.addEventListener("scroll", function() {
        const btn = document.getElementById("scrollTopBtn");
        if (window.scrollY > 200 || document.documentElement.scrollTop > 200) {
            btn.style.display = "flex";
        } else {
            btn.style.display = "none";
        }
    });
    function scrollToTop() { window.scrollTo({ top: 0, behavior: 'smooth' }); }

    // --- TRANSLATION DATA ---
    const i18n = {
        EN: {
            tabs: ["All", "Aluminum", "Steel/Iron"],
            btnFilter: "⚙️ Advanced Filter",
            btnReset: "↺ Reset Filters",
            hFund: "1. Fundamental Info",
            hHole: "2. Prepared Hole",
            hPerf: "3. Performance",
            
            tFunc: "Function",
            tProc: "Target Process",
            tCored: "Cored Hole",
            tSolid: "Without Prehole (Solid)",
            tBlind: "Blind Hole",
            tThrough: "Through Hole",
            tRough: "Roughness",
            tPos: "Position Accuracy",
            tCirc: "Circularity",
            
            "Drill": "Drill",
            "Reamer": "Reamer",
            "Drill & Reamer": "Drill & Reamer",
            "General": "General",
            "One Shot": "One Shot (Solid)",
            "For Cored Hole": "For Cored Hole",
            "High Efficiency": "High Efficiency",
            "Excellent": "Excellent",
            "Good": "Good",
            "Fair": "Fair",
            "No": "No",

            cardHeadHole: "Prepared Hole",
            cardHeadPerf: "Performance",
            lblCored: "Cored",
            lblSolid: "Solid",
            lblBlind: "Blind",
            lblThrough: "Through",
            lblRough: "Roughness",
            lblPos: "Position",
            lblCirc: "Circularity",
            lblDia: "Dia Acc.",
            
            btnInfo: "More Information",
            btnCalc: "⚡ Calculate",
            calcTitle: "Cutting Calculator",
            lblSpeed: "Speed (m/min)",
            lblFeed: "Feed (mm/rev)"
        },
        TH: {
            tabs: ["ทั้งหมด", "อะลูมิเนียม", "เหล็ก/เหล็กหล่อ"],
            btnFilter: "⚙️ ตัวกรองละเอียด",
            btnReset: "↺ ล้างตัวกรอง",
            hFund: "1. ข้อมูลพื้นฐาน",
            hHole: "2. สภาพรูตั้งต้น",
            hPerf: "3. สมรรถนะ",
            
            tFunc: "หน้าที่เครื่องมือ",
            tProc: "ลักษณะกระบวนการ",
            tCored: "รูหล่อ",
            tSolid: "เนื้อเต็ม",
            tBlind: "รูตัน",
            tThrough: "รูทะลุ",
            tRough: "ความเรียบผิวรู",
            tPos: "ความแม่นยำตำแหน่ง",
            tCirc: "ความกลม",
            
            "Drill": "ดอกสว่าน",
            "Reamer": "รีมเมอร์",
            "Drill & Reamer": "ดอกสว่าน+รีมเมอร์",
            "General": "งานทั่วไป",
            "One Shot": "เจาะครั้งเดียว",
            "For Cored Hole": "สำหรับรูหล่อ",
            "High Efficiency": "ประสิทธิภาพสูง",
            "Excellent": "ดีเยี่ยม",
            "Good": "ดี",
            "Fair": "พอใช้",
            "No": "ไม่รองรับ",

            cardHeadHole: "สภาพรูตั้งต้น",
            cardHeadPerf: "สมรรถนะ",
            lblCored: "รูหล่อ",
            lblSolid: "รูตัน",
            lblBlind: "รูไม่ทะลุ",
            lblThrough: "รูทะลุ",
            lblRough: "ความเรียบ",
            lblPos: "ตำแหน่ง",
            lblCirc: "ความกลม",
            lblDia: "ขนาดรู",
            
            btnInfo: "รายละเอียด",
            btnCalc: "⚡ คำนวณ",
            
            calcTitle: "โปรแกรมคำนวณ",
            lblSpeed: "ความเร็วตัด (m/min)",
            lblFeed: "อัตราป้อน (mm/rev)"
        }
    };

    // --- DATA ---
    const tools = [
        // ALUMINUM
        { id: "gkz", name: "GKZ Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gkdrill.html", img: "images/gkz_main.jpg", func: "Drill", proc: "General", hole: { cored: "Good", solid: "Excellent", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Good", pos: "Good" }, feat_en: "Excellent straightness even in cored holes. DLC coating.", feat_th: "รูตรงเยี่ยมแม้ในรูหล่อ เคลือบ DLC ทนทาน", calc: { vc_min: 50, vc_max: 250, f_min: 0.02, f_max: 0.04, f_mode: "fac" } },
        { id: "gkt", name: "GKT Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gkdrill.html", img: "images/gkt_main.jpg", func: "Drill", proc: "For Cored Hole", hole: { cored: "Excellent", solid: "Fair", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Good", pos: "Excellent" }, feat_en: "3-flute design for high positional accuracy in cored holes.", feat_th: "3 คมตัด ให้ตำแหน่งแม่นยำสูงในงานรูหล่อ", calc: { vc_min: 50, vc_max: 200, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "g7x", name: "G7X Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/g7drill.html", img: "images/g7x_main.jpg", func: "Drill & Reamer", proc: "One Shot", hole: { cored: "Good", solid: "Excellent", through:"Good", blind:"Good" }, perf: { dia: "IT7", circ: "Excellent", rough: "Excellent", pos: "Good" }, feat_en: "IT7 accuracy in one shot (Drill + Reamer).", feat_th: "ได้รูระดับ IT7 ในครั้งเดียว (เจาะ+รีม)", calc: { vc_min: 50, vc_max: 200, f_min: 0.1, f_max: 0.2, f_mode: "fix" } },
        { id: "gp", name: "GP Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gpdrill.html", img: "images/gp_main.jpg", func: "Drill", proc: "One Shot", hole: { cored: "Good", solid: "Excellent", through:"Good", blind:"Good" }, perf: { dia: "IT8", circ: "Good", rough: "Excellent", pos: "Good" }, feat_en: "PCD-tipped for high speed & long life (IT8).", feat_th: "หัว PCD เจาะเร็ว อายุยาวนาน (IT8)", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.15, f_mode: "fac" } },
        { id: "gpt", name: "GPT Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/gpdrill.html", img: "images/gpt_main.jpg", func: "Drill", proc: "For Cored Hole", hole: { cored: "Excellent", solid: "Fair", through:"Good", blind:"Good" }, perf: { dia: "IT8", circ: "Good", rough: "Excellent", pos: "Excellent" }, feat_en: "3-flute PCD for high speed in cored holes.", feat_th: "PCD 3 คมตัด เจาะเร็วสำหรับรูหล่อ", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "gjt", name: "GJT Drill", cat: "al", link: "pdfs/gjt.pdf", img: "images/gjt_main.jpg", func: "Drill", proc: "For Cored Hole", hole: { cored: "Excellent", solid: "Fair", through:"Good", blind:"Good" }, perf: { dia: "IT7", circ: "Excellent", rough: "Excellent", pos: "Excellent" }, feat_en: "3 PCD edges + 6 guide pads for IT7 roundness.", feat_th: "3 คม PCD + 6 ไกด์ ได้ความกลม IT7", calc: { vc_min: 50, vc_max: 300, f_min: 0.02, f_max: 0.05, f_mode: "fac" } },
        { id: "gd", name: "GD Drill", cat: "al", link: "pdfs/gd.pdf", img: "images/gd_main.jpg", func: "Drill & Reamer", proc: "One Shot", hole: { cored: "Fair", solid: "Excellent", through:"Good", blind:"Good" }, perf: { dia: "IT7", circ: "Excellent", rough: "Excellent", pos: "Good" }, feat_en: "PCD reamer + pilot drill for IT7 in one pass.", feat_th: "รีม PCD + ดอกนำเจาะ ได้ IT7 ในครั้งเดียว", calc: { vc_min: 100, vc_max: 200, f_min: 0.05, f_max: 0.2, f_mode: "fix" } },
        { id: "tfh", name: "TFH Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/tfhdrill.html", img: "images/tfh_main.jpg", func: "Drill", proc: "High Efficiency", hole: { cored: "Fair", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Good", pos: "Good" }, feat_en: "Low resistance, high feed (0.15D).", feat_th: "แรงต้านต่ำ ฟีดสูง (0.15D)", calc: { vc_min: 50, vc_max: 150, f_min: 0.05, f_max: 0.15, f_mode: "fac", f_limit: 2.0 } },
        { id: "manmaruz", name: "Manmaru Z Reamer", cat: "al", link: "https://www.c-max.co.jp/en/products/zreamer.html", img: "images/manmaruz_main.jpg", func: "Reamer", proc: "High Efficiency", hole: { cored: "No", solid: "No", through:"Good", blind:"Fair" }, perf: { dia: "IT7", circ: "Excellent", rough: "Excellent", pos: "No" }, feat_en: "Stable roundness in intermittent cutting.", feat_th: "ความกลมเสถียร แม้ตัดแบบไม่ต่อเนื่อง", calc: { vc_min: 50, vc_max: 400, f_min: 0.05, f_max: 0.2, f_mode: "fix" } },
        { id: "parapara", name: "Parapara Drill", cat: "al", link: "https://www.c-max.co.jp/en/products/paraparadrill.html", img: "images/parapara_main.jpg", func: "Drill", proc: "General", hole: { cored: "Good", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Fair", pos: "Good" }, feat_en: "Breaks chips into small pieces for deep holes.", feat_th: "หักเศษเล็ก เหมาะสำหรับเจาะรูลึก", calc: { vc_min: 50, vc_max: 150, f_min: 0.02, f_max: 0.1, f_mode: "fac" } },
        { id: "balance", name: "Balance Reamer", cat: "al", link: "https://www.c-max.co.jp/en/products/balancereamer.html", img: "images/balance_main.jpg", func: "Reamer", proc: "General", hole: { cored: "Good", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT7", circ: "Good", rough: "Excellent", pos: "Good" }, feat_en: "Outstanding rotational balance for deep holes.", feat_th: "สมดุลหมุนดีเยี่ยม สำหรับรูลึก", calc: { vc_min: 100, vc_max: 300, f_min: 0.05, f_max: 0.1, f_mode: "fix" } },
        
        // STEEL
        { id: "tfs", name: "TFS Drill", cat: "st", link: "https://www.c-max.co.jp/en/products/tfsdrill.html", img: "images/tfs_main.jpg", func: "Drill", proc: "General", hole: { cored: "No", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Good", pos: "Good" }, feat_en: "Low-resistance edge for Steel/Cast Iron.", feat_th: "คมตัดแรงต้านต่ำ สำหรับเหล็ก/เหล็กหล่อ", calc: { vc_min: 50, vc_max: 120, f_min: 0.01, f_max: 0.05, f_mode: "fac" } },
        { id: "gix", name: "GIX Drill", cat: "st", link: "pdfs/gix.pdf", img: "images/gix_main.jpg", func: "Drill", proc: "General", hole: { cored: "No", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT9", circ: "Good", rough: "Good", pos: "Good" }, feat_en: "Straight flutes for cast iron straightness.", feat_th: "ร่องตรงเพื่อความตรงในงานเหล็กหล่อ", calc: { vc_min: 50, vc_max: 150, f_min: 0.04, f_max: 0.04, f_mode: "fac", f_limit: 0.1 } },
        { id: "gf", name: "GF Drill", cat: "st", link: "pdfs/gf.pdf", img: "images/gf_main.jpg", func: "Drill & Reamer", proc: "One Shot", hole: { cored: "No", solid: "Good", through:"Good", blind:"Good" }, perf: { dia: "IT8", circ: "Good", rough: "Good", pos: "Good" }, feat_en: "2 pilot + 4 reaming edges for cast iron (IT8).", feat_th: "2 คมนำ + 4 คมรีม สำหรับเหล็กหล่อ (IT8)", calc: { vc_min: 20, vc_max: 100, f_min: 0.05, f_max: 0.3, f_mode: "fix" } },
        { id: "ghi", name: "GHI Reamer", cat: "st", link: "https://www.c-max.co.jp/en/products/ghireamer.html", img: "images/ghi_main.jpg", func: "Reamer", proc: "High Efficiency", hole: { cored: "No", solid: "No", through:"Good", blind:"Good" }, perf: { dia: "IT7", circ: "Excellent", rough: "Excellent", pos: "No" }, feat_en: "6 unequal edges for roundness & anti-vibration.", feat_th: "6 คมไม่เท่ากัน เพื่อความกลมและลดสั่น", calc: { vc_min: 50, vc_max: 150, f_min: 0.2, f_max: 0.6, f_mode: "fix" } }
    ];

    let curLang = "EN";
    let curMat = "all";

    // --- STAR RENDERER ---
    function renderLvl(lvl) {
        let stars = "";
        let cls = "";
        if(lvl === 'Excellent') { stars = "★★★"; cls = "s-on"; }
        else if(lvl === 'Good') { stars = "★★<span class='s-off'>★</span>"; cls = "s-on"; }
        else if(lvl === 'Fair') { stars = "★<span class='s-off'>★★</span>"; cls = "s-on"; }
        else { stars = "-"; cls = "s-no"; }
        return `<span class="star-box ${cls}">${stars}</span>`;
    }

    // --- MAIN RENDER ---
    function render() {
        const t = i18n[curLang]; // Get current language dictionary
        
        // 1. Update UI Static Texts
        document.getElementById('btnFilterToggle').innerText = t.btnFilter;
        document.getElementById('btnReset').innerText = t.btnReset;
        document.getElementById('tabAll').innerText = t.tabs[0];
        document.getElementById('tabAl').innerText = t.tabs[1];
        document.getElementById('tabSt').innerText = t.tabs[2];

        document.getElementById('hFund').innerText = t.hFund;
        document.getElementById('hHole').innerText = t.hHole;
        document.getElementById('hPerf').innerText = t.hPerf;
        
        document.getElementById('tFunc').innerText = t.tFunc;
        document.getElementById('tProc').innerText = t.tProc;
        document.getElementById('tCored').innerText = t.tCored;
        document.getElementById('tSolid').innerText = t.tSolid;
        document.getElementById('tBlind').innerText = t.tBlind;
        document.getElementById('tThrough').innerText = t.tThrough;
        document.getElementById('tRough').innerText = t.tRough;
        document.getElementById('tPos').innerText = t.tPos;
        document.getElementById('tCirc').innerText = t.tCirc;

        // Update Labels inside Filter
        document.querySelectorAll('span[data-t]').forEach(span => {
            const key = span.dataset.t;
            if(t[key]) span.innerText = t[key];
        });

        // Update Modal
        document.getElementById('calcTitle').innerText = t.calcTitle;
        document.getElementById('lblSpeed').innerText = t.lblSpeed;
        document.getElementById('lblFeed').innerText = t.lblFeed;

        // 2. Render Cards
        const grid = document.getElementById('main-grid');
        grid.innerHTML = "";
        
        const filters = Array.from(document.querySelectorAll('.flt:checked')).map(c=>({k:c.dataset.key, v:c.value}));

        tools.forEach(tool => {
            if(curMat !== 'all' && tool.cat !== curMat) return;

            let pass = true;
            const grouped = {};
            filters.forEach(f => { if(!grouped[f.k]) grouped[f.k]=[]; grouped[f.k].push(f.v); });
            
            for(const k in grouped) {
                const reqs = grouped[k];
                let val = "";
                if(k==='func') val = tool.func;
                if(k==='proc') val = tool.proc;
                if(k.startsWith('hole_')) val = tool.hole[k.split('_')[1]];
                if(k.startsWith('perf_')) val = tool.perf[k.split('_')[1]];
                
                if(!reqs.includes(val)) { pass = false; break; }
            }

            if(pass) {
                const desc = curLang === 'EN' ? tool.feat_en : tool.feat_th;
                const html = `
                <div class="dash-card">
                    <div class="dc-header">
                        <img src="${tool.img}" class="dc-img" onerror="this.src='https://placehold.co/100?text=${tool.name.substr(0,2)}'">
                        <div class="dc-title-box">
                            <h3 class="dc-title">${tool.name}</h3>
                            <div class="dc-sub">
                                <span class="tag">${t[tool.func] || tool.func}</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="dc-dashboard">
                        <div class="dash-row">
                            <div class="dash-col">
                                <div class="dash-head">${t.cardHeadHole}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblCored}</span> ${renderLvl(tool.hole.cored)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblSolid}</span> ${renderLvl(tool.hole.solid)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblBlind}</span> ${renderLvl(tool.hole.blind)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblThrough}</span> ${renderLvl(tool.hole.through)}</div>
                            </div>
                            <div class="dash-col" style="border-left:1px dashed #eee; padding-left:15px;">
                                <div class="dash-head">${t.cardHeadPerf}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblRough}</span> ${renderLvl(tool.perf.rough)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblPos}</span> ${renderLvl(tool.perf.pos)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblCirc}</span> ${renderLvl(tool.perf.circ)}</div>
                                <div class="spec-item"><span class="spec-label">${t.lblDia}</span> <span style="font-weight:bold; font-size:0.8rem;">${tool.perf.dia}</span></div>
                            </div>
                        </div>
                        <div class="dc-feat">"${desc}"</div>
                    </div>

                    <div class="dc-footer">
                        <a href="${tool.link}" target="_blank" class="btn btn-info">${t.btnInfo}</a>
                        <button onclick="openCalc('${tool.id}')" class="btn btn-calc">${t.btnCalc}</button>
                    </div>
                </div>`;
                grid.innerHTML += html;
            }
        });
    }

    function setMat(m, el) {
        curMat = m;
        document.querySelectorAll('.mat-tab').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        render();
    }
    function toggleLang() { curLang = curLang==='EN'?'TH':'EN'; render(); }
    function toggleFilter() { document.getElementById('filterPanel').classList.toggle('show'); }
    function resetFilters() { document.querySelectorAll('.flt').forEach(c=>c.checked=false); render(); }
    document.querySelectorAll('.flt').forEach(c => c.addEventListener('change', render));

    let actTool = null;
    function openCalc(id) {
        actTool = tools.find(t=>t.id===id);
        document.getElementById('calc-tool-name').innerText = actTool.name;
        document.getElementById('inp-dia').value = "";
        document.getElementById('res-vc').innerText = actTool.calc.vc_min + "~" + actTool.calc.vc_max;
        document.getElementById('res-feed').innerText = "-";
        document.getElementById('calcModal').style.display = "flex";
        document.getElementById('inp-dia').focus();
    }
    function calculate() {
        const d = parseFloat(document.getElementById('inp-dia').value);
        if(!d || d<=0) return;
        
        let f_min, f_max;
        if(actTool.calc.f_mode === 'fix') { f_min=actTool.calc.f_min; f_max=actTool.calc.f_max; }
        else { f_min=actTool.calc.f_min*d; f_max=actTool.calc.f_max*d; }
        
        if(actTool.calc.f_limit) { f_min=Math.min(f_min, actTool.calc.f_limit); f_max=Math.min(f_max, actTool.calc.f_limit); }
        
        document.getElementById('res-vc').innerText = actTool.calc.vc_min + "~" + actTool.calc.vc_max;
        const s_min = parseFloat(f_min.toFixed(3));
        const s_max = parseFloat(f_max.toFixed(3));
        document.getElementById('res-feed').innerText = (s_min===s_max) ? s_min : s_min+"~"+s_max;
    }
    function closeModal() { document.getElementById('calcModal').style.display = "none"; }

    // Init
    render();
</script>

</body>
</html>